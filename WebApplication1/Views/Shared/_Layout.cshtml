<!DOCTYPE html>
<html lang="es">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <title>@ViewBag.Title - mi aplicación ASP.NET</title>
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.2/dist/sweetalert2.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.2/dist/sweetalert2.min.css" rel="stylesheet">
    <!--Swee alert-->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    @Styles.Render("~/Content/css")
    @*@Scripts.Render("~/bundles/modernizr")*@
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

</head>
<body>
    <!-- Barra de Navegacion -->
    <nav class="navbar navbar navegacion">
        <div class="container-fluid  navegacion">
            <img class="brz-img texto" srcset="https://cashpak.com/wp-content/uploads/brizy/imgs/cashpak-blanco-178x47x1x0x176x47x1638558904.png 1x, https://cashpak.com/wp-content/uploads/brizy/imgs/cashpak-blanco-356x94x2x0x352x94x1638558904.png 2x" src="https://cashpak.com/wp-content/uploads/brizy/imgs/cashpak-blanco-178x47x0x0x178x47x1638558904.png" alt="" draggable="false" loading="lazy">
        </div>
    </nav>


    <!-- formulario -->
    <div class="container-xl">
        <div class="container text-center salto">
            <div class="row align-items-start">
                <div class="col">
                    <!--Izquierda-->
                </div>
                <div class="col">
                    <!-- formulario Contenedor -->
                    <div class="contenedor justify-content-center row">

                        <div class="formulario text-center">
                            <!-- Formulario-->
                            <div class="mb-3 row">
                                <label for="formGroupExampleInput" class="form-label text-center">Numero de Cuenta</label>
                                <input type="text" class="form-control text-center" id="formGroupExampleInput" placeholder="123456789" maxlength="9">
                            </div>
                            <div class="col-12">
                                <button type="submit" onclick="Mostrar()" class="btn btn-primary">Consultar</button>
                            </div>
                            <!--Fin Formulario-->
                        </div>
                    </div>
                    <!-- formulario Contenor Fin -->

                </div>
                <div class="col">
                    <!--Derecha-->
                </div>
            </div>
        </div>
    </div>






    <script type="text/javascript">

   function Mostrar() {
    Swal.fire({
        title: '¿Quieres consultar esta Tarjeta?',
        showDenyButton: true,
        // showCancelButton: true,
        confirmButtonText: 'Consultar',
    }).then((result) => {
        /* Read more about isConfirmed, isDenied below */
        if (result.isConfirmed) {
            let inputValue = document.getElementById("formGroupExampleInput").value;
            console.log(inputValue);

            var url = "@Url.Action("Credenciales", "Home")";

            const parser = new DOMParser();

            var data = { header : inputValue };
            $.post(url , data).done(function (data){
                var xmlDoc = $.parseXML(data);
                var $xml = $(xmlDoc);
                var $title = $xml.find("faultcode");
                var $state = $xml.find("local_status_account");
                var $stado = $state.text();
                var error = $title.text();
                console.log($title.text());

                if (error == "CASHPAK-ERROR") {
                    Swal.fire('ERROR', $title.text(), 'error')
                } else if ($stado == "C") {
                    Swal.fire('Tarjeta Depurada', "TARJETA ENVIADA A CREDENCIALES", 'error')
                } else {

                    switch ($stado) {

                        case 'A': Swal.fire('Tarjeta Activa', 'TARJETA ASIGNADA', 'success'); break;

                        case 'R': Swal.fire('Tarjeta Activa', 'TARJETA REEMPLAZADA', 'success'); break;
                    }
                }
            });
        } else if (result.isDenied) {
            Swal.fire('', "-----X-----", '')
        }
    })


}


    </script>






    @RenderBody()
    @*@RenderSection("SPAViews", required: false)*@


    @*@Scripts.Render("~/bundles/jquery")*@
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/CREDENCIALES")
    @*@RenderSection("Scripts", required: false)*@


</body>
</html>
